<?xml version="1.0" encoding="utf-8"?>
<Dashboard>
  <Title Text="DB Zaloge - 1" />
  <DataSources>
    <SqlDataSource Name="CustomSqlQuery" ComponentName="sqlDataSource1">
      <Connection Name="eHolding ERFA" FromAppConfig="true" />
      <Query Type="CustomSqlQuery" Name="CustomSqlQuery">
        <Sql>select * from dbo.uTN_DB_Zaloge</Sql>
      </Query>
      <ConnectionOptions CloseConnection="true" />
      <CalculatedFields>
        <CalculatedField Name="ZalogaObratDni" Expression="((ZalogaKoličinaEM-ZalogaPrevzemKoličina+ZalogaIzdajaKoličina)*365+ZalogaPrevzemDniDoDanes-ZalogaIzdajaDniDoDanes)/&#xD;&#xA;(ZalogaKoličinaEM-ZalogaPrevzemKoličina+ZalogaIzdajaKoličina+ZalogaPrevzemKoličina)" DataType="Auto" DataMember="CustomSqlQuery" />
        <CalculatedField Name="ZalogaZadostujeDni" Expression="[ZalogaKoličinaEM]/&#xD;&#xA;(Iif([ZalogaIzdajaKoličina]=0,1,[ZalogaIzdajaKoličina])/&#xD;&#xA;Iif(([ZalogaKoličinaEM]-[ZalogaPrevzemKoličina]+[ZalogaIzdajaKoličina])=0,DateDiffDay([ZalogaDatumPrvegaPrevzema],LocalDateTimeNow()), 365))" DataType="Auto" DataMember="CustomSqlQuery" />
        <CalculatedField Name="ZalogaObdobjeZaležanosti" Expression="Iif([ZalogaObratDni]&lt;15, 'Do  15 dni',&#xD;&#xA;Iif([ZalogaObratDni]&lt;30, 'Do  30 dni',&#xD;&#xA;Iif([ZalogaObratDni]&lt;45, 'Do  45 dni',&#xD;&#xA;Iif([ZalogaObratDni]&lt;60, 'Do  60 dni',&#xD;&#xA;Iif([ZalogaObratDni]&lt;90, 'Do  90 dni',&#xD;&#xA;Iif([ZalogaObratDni]&lt;180,'Do 180 dni','Nad 180 dni'))))))" DataType="Auto" DataMember="CustomSqlQuery" />
        <CalculatedField Name="ZalogaZačetnoStanje" Expression="sum([ZalogaKoličinaEM])-sum([ZalogaPrevzemKoličina])+sum([ZalogaIzdajaKoličina])" DataType="Auto" DataMember="CustomSqlQuery" />
      </CalculatedFields>
    </SqlDataSource>
  </DataSources>
  <Items>
    <Pie ComponentName="pieDashboardItem1" Name="Vrednost trenutne zaloge po primarni klasifikaciji" ShowCaption="false" DataSource="sqlDataSource1" DataMember="CustomSqlQuery" IsMasterFilterCrossDataSource="true" PieType="Donut" LabelContentType="ArgumentValueAndPercent">
      <InteractivityOptions MasterFilterMode="Multiple" />
      <DataItems>
        <Measure DataMember="ZalogaVrednost" Name="Zaloga po primarni klasifikaciji" DefaultId="DataItem0">
          <NumericFormat FormatType="Currency" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Dimension DataMember="ZalogaPrimarnaKlasifikacijaNaziv" Name="Primarna klasifikacija" DefaultId="DataItem1" />
      </DataItems>
      <Arguments>
        <Argument DefaultId="DataItem1" />
      </Arguments>
      <Values>
        <Value DefaultId="DataItem0" />
      </Values>
    </Pie>
    <Pie ComponentName="pieDashboardItem2" Name="Vrednost trenutne zalogepo dobaviteljih" ShowCaption="false" DataSource="sqlDataSource1" DataMember="CustomSqlQuery" IsMasterFilterCrossDataSource="true" PieType="Donut" LabelContentType="ArgumentValueAndPercent">
      <InteractivityOptions MasterFilterMode="Multiple" />
      <DataItems>
        <Measure DataMember="ZalogaVrednost" Name="Zaloga po dobaviteljih" DefaultId="DataItem0">
          <NumericFormat FormatType="Currency" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Dimension DataMember="ZalogaDobavitelj" Name="Dobavitelj" DefaultId="DataItem1" />
      </DataItems>
      <Arguments>
        <Argument DefaultId="DataItem1" />
      </Arguments>
      <Values>
        <Value DefaultId="DataItem0" />
      </Values>
    </Pie>
    <Pie ComponentName="pieDashboardItem3" Name="Vrednost trenutne zaloge po sekundarni klasifikaciji" ShowCaption="false" DataSource="sqlDataSource1" DataMember="CustomSqlQuery" IsMasterFilterCrossDataSource="true" PieType="Donut" LabelContentType="ArgumentValueAndPercent">
      <InteractivityOptions MasterFilterMode="Multiple" />
      <DataItems>
        <Measure DataMember="ZalogaVrednost" Name="Zaloga po sekundarni klasifikaciji" DefaultId="DataItem0">
          <NumericFormat FormatType="Currency" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Dimension DataMember="ZalogaSekundarnaKlasifikacija_naziv" Name="Sekundarna klasifikacija" DefaultId="DataItem1" />
      </DataItems>
      <Arguments>
        <Argument DefaultId="DataItem1" />
      </Arguments>
      <Values>
        <Value DefaultId="DataItem0" />
      </Values>
    </Pie>
    <Grid ComponentName="gridDashboardItem1" Name="Pregled začoge po identih" ShowCaption="false" DataSource="sqlDataSource1" DataMember="CustomSqlQuery">
      <DataItems>
        <Dimension DataMember="ZalogaIdent" DefaultId="DataItem0" />
        <Dimension DataMember="ZalogaIdentNaziv" DefaultId="DataItem1" />
        <Measure DataMember="ZalogaKoličinaEM" DefaultId="DataItem2">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Dimension DataMember="ZalogaEnotaMere" DefaultId="DataItem3" />
        <Measure DataMember="ZalogaVrednost" DefaultId="DataItem4">
          <NumericFormat FormatType="Currency" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Measure DataMember="ZalogaObratDni" DefaultId="DataItem5">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" />
        </Measure>
        <Dimension DataMember="ZalogaObdobjeZaležanosti" Name="Obrat dni" SortOrder="Descending" SortByMeasure="DataItem5" DefaultId="DataItem6" />
        <Measure DataMember="ZalogaZadostujeDni" DefaultId="DataItem7">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" />
        </Measure>
        <Measure DataMember="ZalogaOdprtaKoličina" DefaultId="DataItem8">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
      </DataItems>
      <HiddenDimensions>
        <Dimension DefaultId="DataItem6" />
      </HiddenDimensions>
      <GridColumns>
        <GridDimensionColumn Name="Ident" Weight="38.15139165871846">
          <Dimension DefaultId="DataItem0" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Naziv identa" Weight="187.28864996098153">
          <Dimension DefaultId="DataItem1" />
        </GridDimensionColumn>
        <GridMeasureColumn Name="Zaloga" Weight="72.256423596057687">
          <Measure DefaultId="DataItem2" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
        <GridDimensionColumn Name="EM" Weight="28.902569438423075">
          <Dimension DefaultId="DataItem3" />
        </GridDimensionColumn>
        <GridMeasureColumn Name="Vrednost" Weight="78.0369374837423">
          <Measure DefaultId="DataItem4" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
        <GridMeasureColumn Name="Obrat dni" Weight="59.539293043151538" DisplayMode="Bar">
          <Measure DefaultId="DataItem5" />
        </GridMeasureColumn>
        <GridMeasureColumn Name="Zadostuje dni" Weight="67.053961097141539">
          <Measure DefaultId="DataItem7" />
        </GridMeasureColumn>
        <GridMeasureColumn Name="Odprta naročila" Weight="68.770773721783883">
          <Measure DefaultId="DataItem8" />
        </GridMeasureColumn>
      </GridColumns>
      <GridOptions EnableBandedRows="true" ColumnWidthMode="Manual" />
    </Grid>
    <Pie ComponentName="pieDashboardItem4" Name="Vrednost trenutne zaloge glede na hitrost obračanja" ShowCaption="false" DataSource="sqlDataSource1" DataMember="CustomSqlQuery" IsMasterFilterCrossDataSource="true" PieType="Donut" LabelContentType="ArgumentValueAndPercent">
      <InteractivityOptions MasterFilterMode="Multiple" IsDrillDownEnabled="true" />
      <DataItems>
        <Measure DataMember="ZalogaVrednost" Name="Zaloga glede na obrat" DefaultId="DataItem0">
          <NumericFormat FormatType="Currency" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Dimension DataMember="ZalogaObdobjeZaležanosti" Name="Obrat zaloge" DefaultId="DataItem1" />
        <Dimension DataMember="ZalogaDobavitelj" Name="Dobavitelj" DefaultId="DataItem2" />
        <Dimension DataMember="ZalogaSekundarnaKlasifikacija_naziv" Name="Sekundarna klasifikacija" DefaultId="DataItem3" />
      </DataItems>
      <Arguments>
        <Argument DefaultId="DataItem1" />
        <Argument DefaultId="DataItem2" />
        <Argument DefaultId="DataItem3" />
      </Arguments>
      <Values>
        <Value DefaultId="DataItem0" />
      </Values>
    </Pie>
    <ListBox ComponentName="listBoxDashboardItem1" Name="Skladišče" DataSource="sqlDataSource1" DataMember="CustomSqlQuery">
      <DataItems>
        <Dimension DataMember="ZalogaSkladišče" Name="Skladišče" DefaultId="DataItem0" />
      </DataItems>
      <FilterDimensions>
        <Dimension DefaultId="DataItem0" />
      </FilterDimensions>
    </ListBox>
  </Items>
  <LayoutTree>
    <LayoutGroup Orientation="Vertical">
      <LayoutGroup Weight="1.0125470514429109">
        <LayoutItem DashboardItem="pieDashboardItem4" Weight="1.1068165504934149" />
        <LayoutItem DashboardItem="pieDashboardItem2" Weight="1.0501876047069081" />
        <LayoutItem DashboardItem="pieDashboardItem1" Weight="1.003817473031918" />
      </LayoutGroup>
      <LayoutGroup Weight="0.98745294855708909">
        <LayoutItem DashboardItem="listBoxDashboardItem1" Weight="0.2615705676298124" />
        <LayoutItem DashboardItem="gridDashboardItem1" Weight="1.4334704262213487" />
        <LayoutItem DashboardItem="pieDashboardItem3" Weight="0.78611169595482466" />
      </LayoutGroup>
    </LayoutGroup>
  </LayoutTree>
</Dashboard>