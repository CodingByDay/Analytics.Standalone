<?xml version="1.0" encoding="utf-8"?>
<Dashboard>
  <Title Text="Modul DENAR" />
  <DataSources>
    <SqlDataSource Name="Modul DENAR" ComponentName="sqlDataSource1">
      <Connection Name="PetPak" FromAppConfig="true" />
      <Query Type="CustomSqlQuery" Name="CustomSqlQuery">
        <Sql>select at.ACKEY																AS DenarŠtevilkaTemeljnice,								--	Številka temeljnice
       at.ACDOCTYPE														AS DenarPoslovniDogodekTemeljnice,				--	Poslovni dogodek temeljnice
       sdtt.acName														AS DenarPoslovniDogodekTemeljniceNaziv,		--	Naziv poslovnega dogodka temeljnice
       isnull(at.ADDATE,'')										AS DenarDatumTemeljnice,									--	Datum temeljnice
       DATEPART(YEAR, isnull(at.adDate,''))		AS DenarTemeljnicaLeto,										--	Leto temeljnice
       DATEPART(MONTH, isnull(at.adDate,''))	AS DenarTemeljnicMesec,										--	Mesec temeljnice
       ati.anNo																AS DenarPozicijaTemeljnice,								--	Pozicija temeljnice
       ati.acAcct															AS DenarKonto,														--	Konto
       sa.acName															AS DenarKontoNaziv,												--	Naziv konta
       isnull(ati.acSubject,'')								AS DenarSubjekt,													--	Subjekt (Kupec/Dobavitelj)
       ati.anDebit														AS DenarDebet,														--	Vrednost Debet
       ati.anCredit														AS DenarKredit,														--	Vrednost Kredit
       ati.acDoc															AS DenarDokument,													--	Številka knjiženega dokumenta
       substring(ati.acDoc,4,4)								AS DenarPoslovniDogodekDokumenta,					--	Poslovni dogodek knjiženega dokumenta
       sdtd.acName														AS DenarPoslovniDogodekDokumentaNaziv,		--	Naziv poslovnega dogodka knjiženega dokumenta
       ati.adDateDoc													AS DenarDokumentDatumDokumenta,						--	Datum knjiženega dokumenta
       ati.adDateDue													AS DenarDokumentDatumZapadlosti,					--	Datum zapadlosti knjiženega dokumenta
       ati.acDept															AS DenarOddelek,													--	Oddelek
       ati.acNote															AS DenarOpomba,														--	Opomba
       ati.acLinkDoc													AS DenarVezniDokument,										--	Številka veznega dokumneta
       ati.acForeignDoc												AS DenarTujDokument,											--	Številka originalnega dokumenta
       ati.acCostDrv													AS DenarStroškovniNosilec,								--	Stroškovni nosilec
       cd.ACNAME															AS DenarStroškovniNosilecNaziv,						--	Naziv stroškovnega nosilca
			 left(ati.acAcct,1)											AS DenarSint1,														--	Enomestna sintetika
			 left(sa1.acname,100)										AS DenarSint1Naziv,												--	Naziv enomestne sintetike
			 left(ati.acAcct,2)											AS DenarSint2,														--	Dvomestna sintetika
			 left(sa2.acname,100)										AS DenarSint2Naziv,												--	Naziv dvomestne sintetike
			 left(ati.acAcct,3)											AS DenarSint3,														--	Trimestna sinetetika
			 left(sa3.acname,100)										AS DenarSint3Naziv												--	Naziv trimestne sintetike
  from .dbo."tHE_AcctTransItem" ati (NOLOCK)
left join .dbo."tHE_AcctTrans" at (NOLOCK) on at.ACKEY=ati.acKey
left join .dbo."tHE_SetAccount" sa (NOLOCK) on sa.acAcct=ati.acAcct
left join .dbo."tHE_SetAccount" sa1 (NOLOCK) on sa1.acAcct=left(ati.acAcct,1)
left join .dbo."tHE_SetAccount" sa2 (NOLOCK) on sa2.acAcct=left(ati.acAcct,2)
left join .dbo."tHE_SetAccount" sa3 (NOLOCK) on sa3.acAcct=left(ati.acAcct,3)
left join .dbo."tPA_SetDocType" sdtt (NOLOCK) on sdtt.acDocType=at.ACDOCTYPE
left join .dbo."tPA_SetDocType" sdtd (NOLOCK) on sdtd.acDocType=substring(ati.acDoc,4,4)
left join .dbo."tHE_CostDrv" cd (NOLOCK) on cd.ACCOSTDRV=ati.acCostDrv
WHERE at.ACDOCTYPE NOT IN ('4900','4901');</Sql>
      </Query>
      <ConnectionOptions CloseConnection="true" />
      <CalculatedFields>
        <CalculatedField Name="Saldo" Expression="sum([DenarDebet])-sum([DenarKredit])" DataType="Auto" DataMember="CustomSqlQuery" />
        <CalculatedField Name="Saldo2" Expression="sum([DenarKredit])-sum([DenarDebet])" DataType="Auto" DataMember="CustomSqlQuery" />
        <CalculatedField Name="Saldo3" Expression="sum([DenarKredit])-sum([DenarDebet])" DataType="Auto" DataMember="CustomSqlQuery" />
      </CalculatedFields>
    </SqlDataSource>
  </DataSources>
  <Items>
    <Grid ComponentName="gridDashboardItem1" Name="Po razredih" DataSource="sqlDataSource1" DataMember="CustomSqlQuery">
      <DataItems>
        <Dimension DataMember="DenarSint1" TopNMeasure="DataItem2" DefaultId="DataItem0" />
        <Dimension DataMember="DenarSint1Naziv" DefaultId="DataItem1" />
        <Measure DataMember="DenarDebet" DefaultId="DataItem2">
          <NumericFormat FormatType="Currency" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Measure DataMember="DenarKredit" DefaultId="DataItem3">
          <NumericFormat FormatType="Currency" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Measure DataMember="Saldo" DefaultId="DataItem4" />
      </DataItems>
      <GridColumns>
        <GridDimensionColumn Name="Razred" Weight="13.521634615384613">
          <Dimension DefaultId="DataItem0" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Naziv" Weight="232.57211538461536">
          <Dimension DefaultId="DataItem1" />
        </GridDimensionColumn>
        <GridMeasureColumn Name="Debet" Weight="52.509014423076913">
          <Measure DefaultId="DataItem2" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
        <GridMeasureColumn Name="Kredit" Weight="37.409855769230766">
          <Measure DefaultId="DataItem3" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
        <GridMeasureColumn Weight="38.987379807692307">
          <Measure DefaultId="DataItem4" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
      </GridColumns>
      <GridOptions ColumnWidthMode="Manual" />
    </Grid>
    <Grid ComponentName="gridDashboardItem2" Name="Dvomestna sintetika" DataSource="sqlDataSource1" DataMember="CustomSqlQuery">
      <DataItems>
        <Dimension DataMember="DenarSint2" DefaultId="DataItem0" />
        <Dimension DataMember="DenarSint2Naziv" DefaultId="DataItem1" />
        <Measure DataMember="DenarDebet" DefaultId="DataItem2">
          <NumericFormat FormatType="Currency" Unit="Ones" />
        </Measure>
        <Measure DataMember="DenarKredit" DefaultId="DataItem3">
          <NumericFormat FormatType="Currency" Unit="Ones" />
        </Measure>
        <Measure DataMember="Saldo2" DefaultId="DataItem4">
          <NumericFormat FormatType="Currency" Unit="Ones" />
        </Measure>
        <Dimension DataMember="DenarSint2" DefaultId="DataItem5" />
      </DataItems>
      <HiddenDimensions>
        <Dimension DefaultId="DataItem5" />
      </HiddenDimensions>
      <GridColumns>
        <GridDimensionColumn Name="Sintetika" Weight="15.324519230769218">
          <Dimension DefaultId="DataItem0" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Naziv" Weight="230.99459134615364">
          <Dimension DefaultId="DataItem1" />
        </GridDimensionColumn>
        <GridMeasureColumn Name="Debet" Weight="50.931490384615344">
          <Measure DefaultId="DataItem2" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
        <GridMeasureColumn Name="Kredit" Weight="38.7620192307692">
          <Measure DefaultId="DataItem3" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
        <GridMeasureColumn Name="Saldo" Weight="38.987379807692271">
          <Measure DefaultId="DataItem4" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
      </GridColumns>
      <GridOptions ColumnWidthMode="Manual" />
    </Grid>
    <Grid ComponentName="gridDashboardItem3" Name="Tromestna sintetika" DataSource="sqlDataSource1" DataMember="CustomSqlQuery">
      <DataItems>
        <Dimension DataMember="DenarSint3" DefaultId="DataItem0" />
        <Dimension DataMember="DenarSint3Naziv" DefaultId="DataItem1" />
        <Measure DataMember="DenarDebet" DefaultId="DataItem2">
          <NumericFormat FormatType="Currency" Unit="Ones" />
        </Measure>
        <Measure DataMember="DenarKredit" DefaultId="DataItem3">
          <NumericFormat FormatType="Currency" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Measure DataMember="Saldo3" DefaultId="DataItem4">
          <NumericFormat FormatType="Currency" Unit="Ones" />
        </Measure>
      </DataItems>
      <GridColumns>
        <GridDimensionColumn Name="Sintetika">
          <Dimension DefaultId="DataItem0" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Naziv">
          <Dimension DefaultId="DataItem1" />
        </GridDimensionColumn>
        <GridMeasureColumn Name="Debet">
          <Measure DefaultId="DataItem2" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
        <GridMeasureColumn Name="Kredit">
          <Measure DefaultId="DataItem3" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
        <GridMeasureColumn>
          <Measure DefaultId="DataItem4" />
          <Totals>
            <Total Type="Sum" />
          </Totals>
        </GridMeasureColumn>
      </GridColumns>
      <GridOptions />
    </Grid>
    <TabContainer ComponentName="tabContainerDashboardItem1" Name="Tab Container 1">
      <Pages>
        <Page ComponentName="dashboardTabPage1" Name="Page 1" />
        <Page ComponentName="dashboardTabPage2" Name="Page 2" />
      </Pages>
    </TabContainer>
    <ListBox ComponentName="listBoxDashboardItem1" Name="Konti" ParentContainer="dashboardTabPage1" DataSource="sqlDataSource1" DataMember="CustomSqlQuery">
      <DataItems>
        <Dimension DataMember="DenarKonto" Name="Konto" DefaultId="DataItem0" />
        <Dimension DataMember="DenarKontoNaziv" Name="Naziv" DefaultId="DataItem1" />
      </DataItems>
      <FilterDimensions>
        <Dimension DefaultId="DataItem0" />
        <Dimension DefaultId="DataItem1" />
      </FilterDimensions>
    </ListBox>
    <ListBox ComponentName="listBoxDashboardItem2" Name="Dokument" ParentContainer="dashboardTabPage2" DataSource="sqlDataSource1" DataMember="CustomSqlQuery">
      <DataItems>
        <Dimension DataMember="DenarDokument" Name="Dokument" DefaultId="DataItem0" />
      </DataItems>
      <FilterDimensions>
        <Dimension DefaultId="DataItem0" />
      </FilterDimensions>
    </ListBox>
    <ListBox ComponentName="listBoxDashboardItem3" Name="Leto" ParentContainer="groupDashboardItem1" DataSource="sqlDataSource1" DataMember="CustomSqlQuery">
      <DataItems>
        <Dimension DataMember="DenarTemeljnicaLeto" Name="Leto" DefaultId="DataItem0">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" />
        </Dimension>
      </DataItems>
      <FilterDimensions>
        <Dimension DefaultId="DataItem0" />
      </FilterDimensions>
    </ListBox>
    <ListBox ComponentName="listBoxDashboardItem4" Name="Mesec" ParentContainer="groupDashboardItem1" DataSource="sqlDataSource1" DataMember="CustomSqlQuery">
      <DataItems>
        <Dimension DataMember="DenarTemeljnicMesec" Name="Mesec" DefaultId="DataItem0">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" />
        </Dimension>
      </DataItems>
      <FilterDimensions>
        <Dimension DefaultId="DataItem0" />
      </FilterDimensions>
    </ListBox>
  </Items>
  <Groups>
    <Group ComponentName="groupDashboardItem1" Name="Filtri" />
  </Groups>
  <LayoutTree>
    <LayoutGroup>
      <LayoutGroup Orientation="Vertical">
        <LayoutGroup Weight="0.75064935064935046">
          <LayoutItem DashboardItem="gridDashboardItem1" Weight="0.75064935064935046" />
          <LayoutGroup Orientation="Vertical" DashboardItem="groupDashboardItem1">
            <LayoutGroup>
              <LayoutItem DashboardItem="listBoxDashboardItem3" />
              <LayoutItem DashboardItem="listBoxDashboardItem4" />
            </LayoutGroup>
          </LayoutGroup>
          <LayoutTabContainer DashboardItem="tabContainerDashboardItem1" Weight="0.75064935064935046">
            <LayoutTabPage DashboardItem="dashboardTabPage1">
              <LayoutItem DashboardItem="listBoxDashboardItem1" />
            </LayoutTabPage>
            <LayoutTabPage DashboardItem="dashboardTabPage2">
              <LayoutItem DashboardItem="listBoxDashboardItem2" />
            </LayoutTabPage>
          </LayoutTabContainer>
        </LayoutGroup>
        <LayoutGroup Weight="0.75454545454545485">
          <LayoutItem DashboardItem="gridDashboardItem2" />
          <LayoutItem DashboardItem="gridDashboardItem3" />
        </LayoutGroup>
      </LayoutGroup>
    </LayoutGroup>
  </LayoutTree>
</Dashboard>